<html>
    <head>
        <title> QuickJS </title>

        <script type="text/javascript" src="quick_tokenizer.js"></script>
        <script type="text/javascript" src="quick_compiler.js"></script>
        <script type="text/javascript" src="quick_dom.js"></script>
        <script type="text/javascript" src="quick.js"></script>

        <script type="text/javascript">

        function compile () {

            var textarea = window.document.getElementById("jml");

            var tokens = Quick.Tokenizer.parse(textarea.value);
            Quick.Tokenizer.dumpTokens();

            var compiler = Quick.Compiler;
            compiler.render(tokens, function (error, result) {
                if (error) {
                    console.log(error);
                } else {
                    document.getElementById("output").innerHTML = result;
                    eval(result);
                }
            });
        }

        </script>
    </head>

    <body onload="">

<textarea id="jml" cols="80" rows="20">
Element {
    id: elem
    width: 100;
    height: 100;
    left: 200;
    top: if (this.left === 200) return 190;
    background-color: "#ffff00";

    Element {
        id: child
        width: this.elem.width * 2.0;
        height: 200;
        left: 500;
        top: 100;
        background-color: "#ff00ff";
        text: "QuickJS";
        onclick: ^{
            alert("YAY");
            console.log("some output");
        }^;
    }

    Rectangle {
        id: child2
        width: this.child.width * 2.;
        height: 50;
        left: 600;
        top: 0;
        containsMouse: false;
        border-radius: this.containsMouse ? 20 : 10;
        background-color: ^{ console.log("background-color: " + this.containsMouse); return this.containsMouse ? "lightgray" : "gray"; }^;
        onmousedown: ^{ this.containsMouse = true; console.log(this.containsMouse); }^;
        onmouseup: ^{ this.containsMouse = false; console.log(this.containsMouse); }^;
    }
}
</textarea>

        <input type="button" value="compile" onclick="compile()"/>

<pre id="output">

</pre>

    </body>
</html>

