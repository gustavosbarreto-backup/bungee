"use strict";if(!Quick){var Quick={}}var tokenizer=function(){var c,i,line,tokens,bindings,exp,colonOnLine,comment,lineContext;var ret={};function log(msg){if(Quick.verbose){console.log(msg)}}function addToken(type,data){tokens.push({TOKEN:type,DATA:data,LINE:line,CONTEXT:lineContext})}function parseElementName(){var token="";while(c){if(c>="A"&&c<="Z"||c>="a"&&c<="z")token+=c;else break;advance()}return token}function parseExpression(){var expression="";while(c){if(c==="\n"||c===";"){i-=1;break}if(!colonOnLine&&c===":"){i-=1;break}expression+=c;advance()}return expression}function parseInlineBlock(){var block="";advance();while(c){if(c==="}"&&exp[i+1]==="^"){advance();break}block+=c;advance()}return block}function advance(){c=exp[++i];return c}ret.parse=function(input){exp=input;i=-1;line=1;lineContext="";tokens=[];c=undefined;bindings=[];colonOnLine=false;comment=false;while(advance()){if(comment&&c!=="\n")continue;if(c==="/"&&exp[i+1]==="/"){comment=true;continue}if(c==="\n"||c===";"){comment=false;colonOnLine=false;++line;lineContext="";var j=i;var tmpChar=exp[++j];while(tmpChar){if(tmpChar==="\n"){break}lineContext+=tmpChar;tmpChar=exp[++j]}continue}if(c>="A"&&c<="Z"){addToken("ELEMENT",parseElementName());continue}if(c>="a"&&c<="z"||c>="0"&&c<="9"||c==='"'||c==="'"||c==="("||c==="-"||c==="_"){addToken("EXPRESSION",parseExpression());continue}if(c==="{"){addToken("SCOPE_START");continue}if(c==="}"){addToken("SCOPE_END");continue}if(c==="^"&&exp[i+1]==="{"){advance();addToken("EXPRESSION",parseInlineBlock());continue}if(c===":"){colonOnLine=true;addToken("COLON");continue}if(c==="@"){addToken("IS_A");continue}if(c===";"){colonOnLine=false;addToken("SEMICOLON");continue}}if(Quick.verbose){ret.dumpTokens()}return tokens};ret.dumpTokens=function(){for(var i=0;i<tokens.length;++i)console.log("TOKEN: "+tokens[i].TOKEN+" "+(tokens[i].DATA?tokens[i].DATA:""))};return ret}();if(typeof window==="undefined"){module.exports=tokenizer}else{window.Quick.Tokenizer=tokenizer}"use strict";if(!Quick){var Quick={}}var compiler=function(){var compiler={};var ELEM_PREFIX="e";var ELEM_NS="Quick.";var output;var index;var errorCodes={GENERIC:0,UNKNOWN_ELEMENT:1,NO_PROPERTY:2,NO_ELEMENTTYPE:3,NO_TYPENAME:4,NO_EXPRESSION:5,NO_COLON:6,INVALID_PROPERTY_NAME:7};compiler.errorCodes=errorCodes;var errorMessages=[];errorMessages[errorCodes.GENERIC]="generic error";errorMessages[errorCodes.UNKNOWN_ELEMENT]="Cannot create element.";errorMessages[errorCodes.NO_PROPERTY]="No property to assing expression.";errorMessages[errorCodes.NO_ELEMENTTYPE]="No type to create an element.";errorMessages[errorCodes.NO_TYPENAME]="No typename for the new type definition.";errorMessages[errorCodes.NO_COLON]="Property must be followed by a ':'.";errorMessages[errorCodes.NO_EXPRESSION]="No right-hand-side expression or element found.";errorMessages[errorCodes.INVALID_PROPERTY_NAME]="Invalid property name found.";function error(code,token){var ret={};ret.code=code;ret.context=token?token.CONTEXT:undefined;ret.message=errorMessages[code];ret.line=token?token.LINE:-1;return ret}function log(msg){if(Quick.verbose){console.log(msg)}}function isNumeric(c){return c>="0"&&c<="9"}function addIndentation(additional){var indentLevel=index+(additional?additional:0);var i;for(i=indentLevel;i;--i){output+="    "}}function renderBegin(options){if(Quick.debug){addIndentation(1);output+="debugger;\n"}output+="if (!window.Quick) {\n";output+="    window.Quick = {};\n";output+="}\n\n";if(options.module){output+="window.Quick."+options.module+" = function () {\n"}else{output+="(function() {\n"}addIndentation();output+="'use strict';\n\n";addIndentation();output+="var "+ELEM_PREFIX+" = { \n";addIndentation(1);output+="children: [],\n";addIndentation(1);output+="addChild: function(child) {\n";addIndentation(2);output+=ELEM_PREFIX+".children.push(child);\n";addIndentation(2);output+="Quick.Engine.addElement(child);\n";addIndentation(2);output+="return child;\n";addIndentation(1);output+="},\n";addIndentation(1);output+="initializeBindings: function() {\n";addIndentation(2);output+="for (var i = 0; i < "+ELEM_PREFIX+".children.length; ++i) { "+ELEM_PREFIX+".children[i].initializeBindings(); }\n";addIndentation(1);output+="},\n";addIndentation(1);output+="render: function() {\n";addIndentation(2);output+="for (var i = 0; i < "+ELEM_PREFIX+".children.length; ++i) { "+ELEM_PREFIX+".children[i].render(); }\n";addIndentation(1);output+="}\n";addIndentation();output+="};\n\n"}function renderEnd(options){addIndentation();output+=ELEM_PREFIX+".initializeBindings();\n";addIndentation();output+=ELEM_PREFIX+".render();\n";if(options.module){addIndentation();output+="return "+ELEM_PREFIX+";\n";output+="};\n"}else{output+="})();\n"}}function renderBeginElement(type,id){addIndentation();output+=ELEM_PREFIX+".addChild((function() {\n";++index;addIndentation();output+="var "+ELEM_PREFIX+" = new "+ELEM_NS+type+"(";output+=id?'"'+id+'"':"";output+=");\n"}function renderEndElement(){addIndentation();output+="return "+ELEM_PREFIX+";\n";--index;addIndentation();output+="})());\n"}function renderBeginType(type,inheritedType){addIndentation();output+=ELEM_NS+type+" = function (id, parent) {\n";++index;addIndentation();output+="var "+ELEM_PREFIX+" = new "+ELEM_NS+inheritedType+"(id, parent);\n"}function renderEndType(){addIndentation();output+="return "+ELEM_PREFIX+";\n";--index;addIndentation();output+="};\n"}function renderEventHandler(property,value){addIndentation();output+=ELEM_PREFIX+'.addEventHandler("'+property+'", ';output+="function () {\n";addIndentation();output+=value+"\n";addIndentation();output+="});\n"}function renderFunction(property,value){var name=property.slice(property.indexOf(" ")+1,property.indexOf("("));var args=property.slice(property.indexOf("(")+1,-1);addIndentation();output+=ELEM_PREFIX+'.addFunction("'+name+'", ';output+="function ("+args+") {\n";addIndentation();output+=value+"\n";addIndentation();output+="});\n"}function renderProperty(property,value){if(property==="id"){return}if(property.indexOf("on")===0){renderEventHandler(property,value);return}if(property.indexOf("(")!==-1){renderFunction(property,value);return}addIndentation();output+=ELEM_PREFIX+'.addProperty("'+property+'", ';output+="function () {";if(String(value).indexOf("return")!==-1){output+=value+" "}else{output+="return "+value+";"}output+="});\n"}function renderDelegate(property,value){addIndentation();output+=ELEM_PREFIX+".create"+property+" = function () {\n";addIndentation(1);output+="return new "+ELEM_NS+value+"();\n";addIndentation();output+="}\n"}function renderTreeObject(tree){var i;if(tree.typeDefinition){renderBeginType(tree.typeDefinition,tree.type)}else{renderBeginElement(tree.type,tree.id)}for(i=0;i<tree.properties.length;++i){renderProperty(tree.properties[i].name,tree.properties[i].value)}for(i=0;i<tree.delegates.length;++i){renderDelegate(tree.delegates[i].name,tree.delegates[i].value)}for(i=0;i<tree.types.length;++i){renderTreeObject(tree.types[i])}for(i=0;i<tree.elements.length;++i){renderTreeObject(tree.elements[i])}if(tree.typeDefinition){renderEndType()}else{renderEndElement()}}compiler.renderTree=function(tree,options,callback){var i;index=1;output="";renderBegin(options);for(i=0;i<tree.types.length;++i){renderTreeObject(tree.types[i])}for(i=0;i<tree.elements.length;++i){renderTreeObject(tree.elements[i])}renderEnd(options);callback(null,output)};function dumpObjectTree(tree,indent){var i;if(indent===undefined){indent=0}function niceLog(msg){var j;var out="";for(j=0;j<indent;++j){out+="  "}console.log(out+msg)}niceLog("+ Element:");niceLog("|- type: "+tree.type);niceLog("|- type definition: "+tree.typeDefinition);niceLog("|+ Properties:");for(i=0;i<tree.properties.length;++i){niceLog("|--> "+tree.properties[i].name)}niceLog("|+ Delegates:");for(i=0;i<tree.delegates.length;++i){niceLog("|--> "+tree.delegates[i].name+" : "+tree.delegates[i].value)}if(tree.types.length){niceLog("|+ Types:");for(i=0;i<tree.types.length;++i){dumpObjectTree(tree.types[i],indent+2)}}if(tree.elements.length){niceLog("|+ Elements: ");for(i=0;i<tree.elements.length;++i){dumpObjectTree(tree.elements[i],indent+2)}}}compiler.createObjectTree=function(tok,options,callback){var property;var tokens=tok;var token_length=tokens.length;var elementType;var elementTypeDefinition;var i,j;var TreeObject=function(parent){this.id=undefined;this.type=undefined;this.typeDefinition=undefined;this.parent=parent;this.types=[];this.elements=[];this.properties=[];this.delegates=[]};var objectTreeRoot=new TreeObject;objectTreeRoot.type="RootObject";var objectTree=objectTreeRoot;for(i=0;i<token_length;i+=1){var token=tokens[i];if(token.TOKEN==="IS_A"){if(elementType){elementTypeDefinition=elementType;elementType=undefined}else{callback(error(errorCodes.NO_TYPENAME,token),null);return}}if(token.TOKEN==="ELEMENT"){elementType=token.DATA}if(token.TOKEN==="SCOPE_START"){log("start element description");if(elementType){var tmp=new TreeObject(objectTree);tmp.type=elementType;if(elementTypeDefinition){tmp.typeDefinition=elementTypeDefinition;objectTree.types.push(tmp)}else{objectTree.elements.push(tmp)}objectTree=tmp;elementType=undefined;elementTypeDefinition=undefined}else{callback(error(errorCodes.NO_ELEMENTTYPE,token),null)}}if(token.TOKEN==="SCOPE_END"){log("end element description");objectTree=objectTree.parent}if(token.TOKEN==="EXPRESSION"){var next_token=i+1<token_length?tokens[i+1]:undefined;if(next_token&&next_token.TOKEN==="COLON"){property=token.DATA;log("property found '"+property+"'");if(isNumeric(property[0])){log("property name '"+property+"' is invalid.");callback(error(errorCodes.INVALID_PROPERTY_NAME,token),null);return}i+=1;next_token=undefined}else{callback(error(errorCodes.NO_COLON,token),null);return}next_token=i+1<token_length?tokens[i+1]:undefined;if(next_token&&next_token.TOKEN==="EXPRESSION"){log("right-hand-side expression found for property '"+property+"' '"+next_token.DATA+"'");if(property==="id"){objectTree.id=next_token.DATA}else{objectTree.properties.push({name:property,value:next_token.DATA})}i+=1;property=undefined}else if(next_token&&next_token.TOKEN==="ELEMENT"){log("right-hand-side element found for property",property,next_token.DATA);objectTree.delegates.push({name:property,value:next_token.DATA});i+=1;property=undefined}else{callback(error(errorCodes.NO_EXPRESSION,next_token),null);return}}}callback(null,objectTreeRoot)};compiler.compileAndRender=function(tok,options,callback){compiler.createObjectTree(tok,options,function(error,result){if(error){callback(error,null);return}if(options.dump){dumpObjectTree(result)}compiler.renderTree(result,options,callback)})};return compiler}();if(typeof window==="undefined"){module.exports=compiler}else{window.Quick.Compiler=compiler}"use strict";if(!Quick){var Quick={}}Quick.Item=function(id,parent,typeHint){var elem=new Quick.Element(id,parent,typeHint?typeHint:"item");elem.addProperty("className","");elem.addProperty("width",100);elem.addProperty("height",100);elem.addProperty("top",0);elem.addProperty("left",0);elem.addProperty("childrenWidth",function(){var left=0;var right=0;var kids=this.children();for(var i in kids){if(kids.hasOwnProperty(i)){var c=kids[i];if(c.left<left){left=c.left}if(c.left+c.width>right){right=c.left+c.width}}}return right-left});elem.addProperty("childrenHeight",function(){var top=0;var bottom=0;var kids=this.children();for(var i in kids){if(kids.hasOwnProperty(i)){var c=kids[i];if(c.top<top){top=c.top}if(c.top+c.height>bottom){bottom=c.top+c.height}}}return bottom-top});return elem};Quick.InputItem=function(id,parent){var elem=new Quick.Item(id,parent,"InputItem");elem.addProperty("width",function(){return this.parent?this.parent.width:0});elem.addProperty("height",function(){return this.parent?this.parent.height:0});elem.addProperty("mouseAbsX",0);elem.addProperty("mouseAbsY",0);elem.addProperty("mouseRelX",0);elem.addProperty("mouseRelY",0);elem.addProperty("mouseRelStartX",0);elem.addProperty("mouseRelStartY",0);elem.addProperty("mousePressed",false);elem.addProperty("containsMouse",false);elem.addProperty("scrollTop",0);elem.addProperty("scrollLeft",0);elem.addProperty("srollWidth",0);elem.addProperty("scrollHeight",0);return elem};var tmpTextElement;Quick.Text=function(id,parent){var elem=new Quick.Item(id,parent);elem.addProperty("mouseEnabled",false);elem.addProperty("textWidth",0);elem.addProperty("textHeight",0);elem.addProperty("fontSize","");elem.addProperty("fontFamily","");elem.addProperty("text","");elem.addProperty("-text",function(){return this.text});elem.addProperty("width",function(){return this.textWidth});elem.addProperty("height",function(){return this.textHeight});if(!tmpTextElement){tmpTextElement=window.document.createElement("div");tmpTextElement.style.position="absolute";tmpTextElement.style.visibility="hidden";tmpTextElement.style.width="auto";tmpTextElement.style.height="auto";tmpTextElement.style.left=-1e4;document.body.appendChild(tmpTextElement)}function relayout(){var tmpProperty=elem.text;var width=0;var height=0;tmpTextElement.style.fontSize=elem.fontSize;tmpTextElement.style.fontFamily=elem.fontFamily;if(tmpTextElement.innerHTML===tmpProperty){width=tmpTextElement.clientWidth+1;height=tmpTextElement.clientHeight+1}else if(tmpProperty!==""){tmpTextElement.innerHTML=tmpProperty;width=tmpTextElement.clientWidth+1;height=tmpTextElement.clientHeight+1}elem.textWidth=width;elem.textHeight=height}elem.addChanged("text",relayout);return elem};Quick.Window=function(id,parent){var elem=new Quick.Element(id,parent);elem.addProperty("innerWidth",window.innerWidth);elem.addProperty("innerHeight",window.innerHeight);elem.addEventHandler("load",function(){var that=this;window.addEventListener("resize",function(event){that.innerWidth=event.srcElement.innerWidth;that.innerHeight=event.srcElement.innerHeight})});return elem};Quick.Rectangle=function(id,parent){var elem=new Quick.Item(id,parent);elem.addProperty("backgroundColor","white");elem.addProperty("borderColor","black");elem.addProperty("borderStyle","solid");elem.addProperty("borderWidth",1);elem.addProperty("borderRadius",0);return elem};Quick.Image=function(id,parent){var elem=new Quick.Item(id,parent);elem.addProperty("textAlign","center");elem.addProperty("src","image.png");elem.addProperty("backgroundImage",function(){if(this.src.indexOf("url('")===0){return this.src}return"url('"+this.src+"')"});return elem};Quick.Input=function(id,parent){var elem=new Quick.Item(id,parent,"input");elem.addProperty("-webkit-user-select","auto");elem.addProperty("userSelect","auto");elem.addProperty("text",function(){return this.element.value});elem.addProperty("placeholder","");return elem};Quick.RendererDOM=function(){this.currentMouseElement=undefined};Quick.RendererDOM.prototype.createElement=function(typeHint,object){var elem;var that=this;if(typeHint==="input"){elem=document.createElement("input")}else{elem=document.createElement("div");elem.style.position="absolute"}if(object.id){elem.id=object.id}if(typeHint==="InputItem"){elem.onscroll=function(e){object.scrollTop=e.target.scrollTop;object.scrollLeft=e.target.scrollLeft;object.srollWidth=e.target.scrollWidth;object.scrollHeight=e.target.scrollHeight};elem.onmouseover=function(){object.containsMouse=true;object.emit("mouseover")};elem.onmouseout=function(){object.containsMouse=false;object.emit("mouseout")};elem.onmousemove=function(event){object.mouseAbsX=event.clientX;object.mouseAbsY=event.clientY;object.mouseRelX=event.layerX;object.mouseRelY=event.layerY;object.emit("mousemove")};if("ontouchstart"in document.documentElement){elem.ontouchstart=function(event){that.currentMouseElement=this;object.mousePressed=true;object.emit("mousedown")};elem.ontouchend=function(event){object.mousePressed=false;object.mouseRelStartX=0;object.mouseRelStartY=0;object.emit("mouseup");if(that.currentMouseElement===this){object.emit("activated")}that.currentMouseElement=undefined}}else{elem.onmousedown=function(event){if(!event.used){that.currentMouseElement=this;event.used=true}object.mousePressed=true;object.mouseRelStartX=event.layerX;object.mouseRelStartY=event.layerY;object.emit("mousedown")};elem.onmouseup=function(event){object.mousePressed=false;object.mouseRelStartX=0;object.mouseRelStartY=0;object.emit("mouseup");if(that.currentMouseElement===this){object.emit("activated")}that.currentMouseElement=undefined}}}return elem};Quick.RendererDOM.prototype.addElement=function(element,parent){if(!element.element){return}if(parent&&parent.element){parent.element.appendChild(element.element)}else{document.body.appendChild(element.element)}};Quick.RendererDOM.prototype.removeElement=function(element,parent){if(!element.element){return}if(parent&&parent.element){parent.element.removeChild(element.element)}else{document.body.removeChild(element.element)}};Quick.RendererDOM.prototype.addElements=function(elements,parent){var fragment=document.createDocumentFragment();for(var i=0;i<elements.length;++i){if(!elements[i].element){continue}fragment.appendChild(elements[i].element)}if(parent&&parent.element){parent.element.appendChild(fragment)}else{document.body.appendChild(fragment)}};Quick.RendererDOM.prototype.renderElement=function(element){var name;if(!element.element){return}for(name in element._dirtyProperties){if(name[0]==="_"){continue}if(name==="-text"){element.element.innerHTML=element[name]}else if(name==="placeholder"){element.element.placeholder=element[name]}else if(name==="className"&&element[name]!==""){element.element.className=element[name]}else if(name==="scale"){var s=element.scale.toFixed(10);var tmp="scale("+s+", "+s+")";element.element.style["-webkit-transform"]=tmp;element.element.style["transform"]=tmp}else{element.element.style[name]=element[name]}}element._dirtyProperties={}};"use strict";if(!Quick){var Quick={}}Quick._animationIndex=0;Quick._debugAnimation=false;Quick.Step=function(id,parent){var elem=new Quick.Element(id,parent,"object");elem.addProperty("percentage",0);return elem};Quick.Animation=function(id,parent){var elem=new Quick.Element(id,parent,"object");var index=Quick._animationIndex++;var dirty=true;var hasRules=false;var animationName="quickAnimation"+index;var keyFramesName="quickAnimationKeyFrames"+index;elem.addProperty("target",function(){return this.parent});elem.addProperty("duration",250);elem.addProperty("delay",0);elem.addProperty("loops",1);elem.addProperty("reverse",false);elem.addProperty("easing","ease");function animationStart(event){Quick._debugAnimation&&console.log("start",event);elem.emit("started")}function animationIteration(event){Quick._debugAnimation&&console.log("iteration",event)}function animationEnd(event){Quick._debugAnimation&&console.log("end",event);elem.stop();elem.emit("finished")}function updateRules(){var rule1="";var rule2="";if(!Quick._style){Quick._style=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(Quick._style)}if(hasRules){var tmpName="."+animationName;var i;for(i=0;i<Quick._style.sheet.cssRules.length;++i){if(Quick._style.sheet.cssRules[i].name===keyFramesName){Quick._style.sheet.deleteRule(i);break}}for(i=0;i<Quick._style.sheet.cssRules.length;++i){if(Quick._style.sheet.cssRules[i].selectorText===tmpName){Quick._style.sheet.deleteRule(i);break}}}rule1+="."+animationName+" {\n";rule1+="   -webkit-animation: ";rule1+=keyFramesName+" ";rule1+=elem.duration+"ms ";rule1+=elem.easing+" ";rule1+=elem.delay+" ";rule1+=elem.loops+" ";rule1+=(elem.reverse?"alternate":"normal")+";\n";rule1+="}\n";rule2+="@-webkit-keyframes "+keyFramesName+" { \n";for(var j in elem.children()){var child=elem.children()[j];if(typeof child.percentage==="undefined"){continue}rule2+="   "+child.percentage+"% { ";for(var property in child._properties){if(child.hasOwnProperty(property)&&property!=="percentage"){rule2+=property+": "+child[property]+"; "}}rule2+=" }"}rule2+="}";Quick._debugAnimation&&console.log("Quick Animation rule",rule1,rule2);Quick._style.sheet.insertRule(rule1,0);Quick._style.sheet.insertRule(rule2,0);hasRules=true}function addEventListeners(){elem._element=elem.target;if(elem._element&&elem._element.element){elem._element.element.addEventListener("webkitAnimationStart",animationStart,false);elem._element.element.addEventListener("webkitAnimationIteration",animationIteration,false);elem._element.element.addEventListener("webkitAnimationEnd",animationEnd,false)}}function markDirty(){dirty=true}elem.addChanged("target",addEventListeners);elem.addChanged("changed",markDirty);elem.start=function(){if(dirty){updateRules();dirty=false}if(elem._element)elem._element.className=animationName};elem.stop=function(){elem._element.className=""};elem.restart=function(){elem.stop();elem.start()};return elem};Quick.Behavior=function(id,parent){var elem=new Quick.Element(id,parent,"object");var index=Quick._animationIndex++;var hasRules=false;var animationName="quickAnimation"+index;elem.addProperty("target",function(){return this.parent});function animationStart(event){Quick._debugAnimation&&console.log("start",event);elem.emit("started")}function animationIteration(event){Quick._debugAnimation&&console.log("iteration",event)}function animationEnd(event){Quick._debugAnimation&&console.log("end",event);elem.stop();elem.emit("finished")}function updateRules(){var rule="";var gotProperties=false;if(!Quick._style){Quick._style=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(Quick._style)}if(hasRules){var tmpName="."+animationName;var i;for(i=0;i<Quick._style.sheet.cssRules.length;++i){if(Quick._style.sheet.cssRules[i].selectorText===tmpName){Quick._style.sheet.deleteRule(i);break}}}if(elem._properties.length===0){return}rule+="."+animationName+" {\n";rule+="   -webkit-transition: ";for(var property in elem._properties){if(elem.hasOwnProperty(property)&&property!=="target"){if(gotProperties){rule+=", "}else{gotProperties=true}rule+=property+" "+elem[property]}}rule+="\n}\n";if(gotProperties&&rule.indexOf("undefined")===-1){Quick._debugAnimation&&console.log("Quick Behavior rule",rule);Quick._style.sheet.insertRule(rule,0);hasRules=true}}function addEventListeners(){elem._element=elem.target;if(elem._element&&elem._element.element){elem._element.element.addEventListener("webkitAnimationStart",animationStart,false);elem._element.element.addEventListener("webkitAnimationIteration",animationIteration,false);elem._element.element.addEventListener("webkitAnimationEnd",animationEnd,false);elem._element.className=animationName}}elem.addChanged("target",addEventListeners);elem.addChanged("changed",updateRules);return elem};"use strict";if(!Quick){var Quick={}}Quick.debug=false;Quick.verbose=false;Quick.run=function(){Quick.useQueryFlags();Quick.compileScriptTags();Quick.Engine.start()};Quick.useQueryFlags=function(){Quick.verbose=window.location.href.indexOf("verbose")>=0;Quick.debug=window.location.href.indexOf("debug")>=0};Quick.compileScriptTagElement=function(script){var tokens=Quick.Tokenizer.parse(script.text);Quick.Compiler.compileAndRender(tokens,{},function(error,result){if(error){console.error("QuickJS compile error: "+error.line+": "+error.message);console.error(" -- "+error.context)}else{try{if(Quick.verbose||Quick.debug){console.log("----------------------");console.log(result);console.log("----------------------");console.log("eval...");var o=new Date;eval(result);var n=new Date;console.log("done, eval took time: ",n-o,"ms")}else{eval(result)}}catch(e){console.error("QuickJS error in generated JavaScript: "+e);console.error(e)}}})};Quick.compileScriptTags=function(scriptType){var type=scriptType?scriptType:"text/jml";for(var i=0;i<window.document.scripts.length;++i){var script=window.document.scripts[i];if(script.type===type){Quick.compileScriptTagElement(script)}}};"use strict";if(!Quick){var Quick={}}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)}}();if(!Quick.Engine){Quick.Engine=function(){var ret={};var getterCalled={};var _dirtyElements={};ret.magicBindingState=false;ret.verbose=false;ret._elementIndex=0;function log(msg,error){if(ret.verbose||error){console.log("[Quick.Engine] "+msg)}}try{var renderer=new Quick.RendererDOM;ret.createElement=renderer.createElement;ret.addElement=renderer.addElement;ret.addElements=renderer.addElements;ret.renderElement=renderer.renderElement;ret.removeElement=renderer.removeElement}catch(e){log("Cannot create DOM renderer",true);ret.createElement=function(){};ret.addElements=function(){};ret.addElement=function(){};ret.renderElement=function(){};ret.removeElement=function(){}}ret.enterMagicBindingState=function(){log("enterMagicBindingState");getterCalled={};ret.magicBindingState=true};ret.exitMagicBindingState=function(){log("exitMagicBindingState\n\n");ret.magicBindingState=false;return getterCalled};ret.addCalledGetter=function(element,property){getterCalled[element.id+"."+property]={element:element,property:property}};var rendering=false;var fps={};fps.d=new Date;fps.l=0;function advance(){if(!rendering){return}window.requestAnimFrame(advance);for(var i in _dirtyElements){_dirtyElements[i].render()}_dirtyElements={};if(Quick.verbose){if(new Date-fps.d>=2e3){console.log("FPS: "+fps.l/2);fps.d=new Date;fps.l=0}else{++fps.l}}}ret.start=function(){rendering=true;advance()};ret.stop=function(){rendering=false};ret.dirty=function(element,property){element._dirtyProperties[property]=true;if(!_dirtyElements[element._internalIndex]){_dirtyElements[element._internalIndex]=element}};return ret}()}Quick.Element=function(id,parent,typeHint){this.id=id;this.typeHint=typeHint;this.parent=parent;if(typeHint!=="object"){this.element=Quick.Engine.createElement(typeHint,this)}else{this.element=null}this._internalIndex=Quick.Engine._elementIndex++;this._dirtyProperties={};this._properties={};this._connections={};this._children={};this._bound={};if(this.parent){this.parent.addChild(this)}};Quick.Element.prototype.children=function(){if(Quick.Engine.magicBindingState){Quick.Engine.addCalledGetter(this,"children")}return this._children};Quick.Element.prototype.removeChild=function(child){Quick.Engine.removeElement(child,this);delete this._children[child._internalIndex];this.emit("children")};Quick.Element.prototype.removeChildren=function(){var i;for(i in this._children){if(this._children.hasOwnProperty(i)){Quick.Engine.removeElement(this._children[i],this)}}this._children={};this.emit("children")};Quick.Element.prototype.addChild=function(child){this[child.id]=child;child[this.id]=this;var i;for(i in this._children){if(this._children.hasOwnProperty(i)){this._children[i][child.id]=child;child[this._children[i].id]=this._children[i]}}this._children[child._internalIndex]=child;child.parent=this;Quick.Engine.addElement(child,this);this.emit("children");return child};Quick.Element.prototype.render=function(){Quick.Engine.renderElement(this)};Quick.Element.prototype.addChanged=function(signal,callback){if(!this._connections[signal]){this._connections[signal]=[]}this._connections[signal][this._connections[signal].length]=callback};Quick.Element.prototype.removeChanged=function(obj,signal){var signalConnections=this._connections[signal];if(!signalConnections){return}for(var i=0;i<signalConnections.length;++i){}};Quick.Element.prototype.addBinding=function(name,value){var that=this;var hasBinding=false;Quick.Engine.enterMagicBindingState();var val=value.apply(this);var getters=Quick.Engine.exitMagicBindingState();this.breakBindings(name);var bindingFunction=function(){that[name]=value.apply(that)};for(var getter in getters){if(getters.hasOwnProperty(getter)){var tmp=getters[getter];this._bound[name][this._bound[name].length]={element:tmp.element,property:tmp.property};tmp.element.addChanged(tmp.property,bindingFunction);hasBinding=true}}return{hasBindings:hasBinding,value:val}};Quick.Element.prototype.addEventHandler=function(event,handler){var that=this;var signal=event;if(signal===""||typeof handler!=="function"){return}if(signal.indexOf("on")===0){signal=signal.slice(2)}this.addChanged(signal,function(){handler.apply(that)})};Quick.Element.prototype.breakBindings=function(name){if(this._bound[name]){for(var i=0;i<this._bound[name].length;++i){this._bound[name][i].element.removeChanged(this,name)}}this._bound[name]=[]};Quick.Element.prototype.setSilent=function(name,value){var setter=this.__lookupSetter__(name);if(typeof setter==="function"){setter.call(this,value,true)}};Quick.Element.prototype.getSilent=function(name){var getter=this.__lookupGetter__(name);if(typeof getter==="function"){return getter.call(this,true)}};Quick.Element.prototype.set=function(name,value){this.breakBindings(name);if(typeof value==="function"){var ret=this.addBinding(name,value);if(ret.hasBindings){this[name]=value}else{this[name]=ret.value}}else{this[name]=value}};Quick.Element.prototype.addFunction=function(name,value){this[name]=value};var defPropCount=0;var notdefPropCount=0;Quick.Element.prototype.addProperty=function(name,value){var that=this;var valueStore;this._properties[name]=value;if(this.hasOwnProperty(name)){this.name=value}else{Object.defineProperty(this,name,{get:function(silent){if(!silent&&Quick.Engine.magicBindingState)Quick.Engine.addCalledGetter(that,name);if(typeof valueStore==="function")return valueStore.apply(that);return valueStore},set:function(val,silent){if(valueStore===val)return;valueStore=val;if(!silent){that.emit(name);that.emit("changed")}Quick.Engine.dirty(that,name)}})}};Quick.Element.prototype.initializeBindings=function(){var name,i;for(name in this._properties){if(this._properties.hasOwnProperty(name)){var value=this._properties[name];if(typeof value==="function"){var ret=this.addBinding(name,value);if(ret.hasBindings){this[name]=value}else{this[name]=ret.value}}else{this[name]=value}}}for(i in this._children){if(this._children.hasOwnProperty(i)){this._children[i].initializeBindings()}}this.emit("load")};Quick.Element.prototype.emit=function(signal){if(signal in this._connections){var slots=this._connections[signal];for(var slot in slots){if(slots.hasOwnProperty(slot)){slots[slot]()}}}};